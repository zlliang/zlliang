---
import { getMeals, formatDate } from '@/utils/meals'

import Layout from '@/layouts/Layout.astro'
import Title from '@/components/Title.astro'

export const prerender = false

const groups = await getMeals()
---

<Layout title="一日三餐">
  <!-- Title -->
  <Title>
    <span>一日三餐</span>
    <span slot="sub-title">认真吃饭的每一天</span>
  </Title>

  <!-- Meals -->
  {groups.map(({ date, meals }) => (
    <div class="my-8">
			<div class="pb-1 mb-2 border-b border-slate-200 text-slate-500 text-sm">{formatDate(date)}</div>
      <div class="space-y-2">
        {meals.map((item) => (
          <div class="flex gap-2">
            <img src={item.image} class="w-[10rem] sm:w-[15rem]" />
            <div class="flex-1">
              <div class="text-sm text-slate-500">{item.type}{item.source && <Fragment><span class="i-lucide-dot" />{item.source}</Fragment>}{item.price && <Fragment><span class="i-lucide-dot" />{`¥${item.price.toFixed(2)}`}</Fragment>}</div>
              <div><strong>{item.name}</strong></div>
              {item.description && <div class="mt-2 text-sm">{item.description}</div>}
            </div>
          </div>
        ))}
      </div>
		</div>
  ))}
</Layout>

<script is:inline type="module">
import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm'
mediumZoom('main img', { background: '#fffd' })
</script>
