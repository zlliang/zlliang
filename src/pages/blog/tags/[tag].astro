---
import Layout from "@/components/Layout.astro"
import PageTitle from "@/components/PageTitle.astro"
import EntryList from "@/components/EntryList.astro"

import { getEntries, getTags } from "@/content"

import type { GetStaticPaths } from "astro"

export const getStaticPaths = (async () => {
  const entries = await getEntries()
  const tags = getTags(entries)

  return tags.map(tag => ({
    params: { tag: tag.slug },
    props: { tag, entries: entries.filter(entry => entry.data.tags?.some(t => t.slug === tag.slug)) },
  }))
}) satisfies GetStaticPaths

const { tag, entries } = Astro.props

const title = `About "${tag.display}"`
---

<Layout title={title} description={title}>
  <!-- Title -->
  <PageTitle>
    <Fragment>{title}</Fragment>
    <Fragment slot="subtitle">{entries.length} in total</Fragment>
  </PageTitle>

  <!-- Entries -->
  <EntryList entries={entries} />
</Layout>
