---
import { format } from "date-fns"

import NoteItem from "@/components/NoteItem.astro"

import { groupNotesByDate } from "@/content"
import { cn } from "@/utils/style"

import type { CollectionEntry } from "astro:content"

interface Props {
  notes: CollectionEntry<"notes">[]
}

const { notes } = Astro.props

const grouped = await groupNotesByDate(notes)
---

<div class="space-y-6">
  {grouped.map(({ date, notes }) => (
    <div>
      <div class="mb-6 px-2 py-1 bg-neutral-100 dark:bg-neutral-800 text-sm text-neutral-500">
        {format(date, "PP")}
      </div>
      {notes.map((note, index) => (
        <div class={cn(index !== notes.length - 1 && "mb-6 pb-6 border-b-2 border-neutral-200 dark:border-neutral-800")}>
          <NoteItem note={note} />
        </div>
      ))}
    </div>
  ))}
</div>
